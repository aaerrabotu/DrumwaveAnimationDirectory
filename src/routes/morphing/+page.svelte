<script lang="ts">
	import { interpolate } from 'flubber';
	import { writable, derived } from 'svelte/store';
	import { spring } from 'svelte/motion';

	const playing = writable(false);
	const t = spring(0);
	const strokeWidth = writable(1);

	function pathdata(a: string, b: string) {
		const interpolator = interpolate(a, b, {
			maxSegmentLength: 2
		});

		return derived(t, interpolator);
	}

	const path1 = pathdata(
		'm144.72,12.89c-9.85,2.03-19.93,10.72-20.16,20.26-.24,9.77,6.38,17.83,2.39,23.66-5.22,7.65-27.95,2.38-30.26,13.72-1,4.9,4.32,12.65,8.06,17.34,4.1,5.13,8.33,8.87,11.07,14.12,5.31,10.17,2.53,21.02-4.77,26.09-4.4,3.05-10.95,3.85-17.7,5.43-5.85,1.37-13.13,3.43-17.7,5.43-9.01,3.94-21.44,11.48-22.29,19.69-1.33,12.82,11.7,16.52,15.35,25.08,3.31,7.74.91,17.92,2.72,26.35,3.53,16.49,15.99,24.49,26.42,29.35,8.08,3.76,19.44,5.73,30.8,3.41,6.68-1.36,15.12-3.96,15.01-9.37-.1-4.99-8.16-11.29-11.91-11.53-4.34-.28-8.86,1.9-12.76,2.06-4.19.18-7.86-.29-9.12-4.47-1.53-5.08,2.79-7.92,4.79-10.79,2.41-3.44,4.22-7.54,4.79-10.79,2.27-12.81-6.89-31.24,5.93-35.84,11.71-4.2,16.02,11.96,18.94,19.74,3.02,8.04,5.62,16.66,9.89,21.12,3.04,3.17,9.8,5.96,15.47,7.4,9.8,2.48,22.8,4.56,33.35-2.82,9.85-6.88,15.97-23.62,13.51-36.82-2.92-15.63-13.96-16.94-24.39-20.93-6.72-2.58-16.31-3.59-18.91-12.68-2.33-8.18,11.13-23.97,27.29-29.75,9.5-3.4,19.11-.4,23.64,3.09,6.54,5.02,9.29,15.09,17.86,14.55,4.05-.26,7.07-2.43,8.41-6.32,10.99-31.69-15.22-71.35-46.85-93.91-13.67-9.75-33.95-16.97-58.9-11.84Z',
		'm197.75,133.55c-17.89,7.4-22.77,13.28-15.07,26.6,37.86,65.51-12.2,67.22-37.51,36.06-12.17-14.98-19.49-15.27-26.84-6.37-45.39,55.02-81.01,15.68-36.61-40.42,13.35-16.86,9.16-30.52,1.35-42.5-21.94-33.67-21.19-50.21-.18-41.46,14.08,5.86,18.48,6.78,21.1-6.8,3.13-16.23,6.66-21.61,19-6.2,7.92,9.89,10.15,16.39,21.96,2.71,10.98-12.72,57.08-44.3,85.91-4.34,28.84,39.95-17.29,76.19-33.11,82.73Z'
	);
	const path2 = pathdata(
		'm12.87,139.62c4.17,9.16,14.88,17.05,24.24,15.16,9.58-1.94,15.96-10.18,22.54-7.59,8.62,3.39,8.53,26.73,20.1,26.46,5-.12,11.37-7.02,15.11-11.71,4.09-5.13,6.8-10.09,11.31-13.93,8.74-7.44,19.94-7.14,26.5-1.14,3.95,3.61,6.19,9.82,9.23,16.05,2.63,5.4,6.26,12.04,9.22,16.05,5.85,7.91,15.96,18.35,24.15,17.36,12.8-1.56,13.51-15.08,21.04-20.54,6.81-4.94,17.27-4.87,25.09-8.5,15.3-7.11,20.32-21.04,22.74-32.28,1.87-8.72,1.26-20.23-3.52-30.79-2.82-6.21-7.22-13.86-12.48-12.55-4.84,1.21-9.19,10.46-8.6,14.17.69,4.29,3.82,8.21,4.85,11.99,1.1,4.04,1.47,7.73-2.33,9.88-4.62,2.62-8.34-.96-11.58-2.28-3.89-1.58-8.29-2.44-11.58-2.28-12.99.64-28.93,13.66-36.27,2.18-6.7-10.48,8.1-18.28,15.03-22.85,7.17-4.73,15-9.18,18.39-14.34,2.41-3.67,3.64-10.88,3.77-16.72.24-10.11-.62-23.25-10.16-31.89-8.9-8.07-26.58-10.32-38.9-4.99-14.59,6.32-13.41,17.38-14.99,28.43-1.02,7.13.12,16.7-8.16,21.25-7.46,4.09-25.84-5.52-35.07-20-5.42-8.5-4.63-18.54-2.24-23.74,3.44-7.49,12.65-12.41,10.21-20.65-1.15-3.89-3.94-6.35-8.03-6.8C59.13,9.34,26.29,43.72,11.32,79.57c-6.47,15.49-9,36.87,1.55,60.05Z',
		'm115.97,61.91c11.19,15.8,18.02,19.25,29.29,8.78,55.44-51.49,68.25-3.06,43.5,28.54-11.9,15.2-10.55,22.4-.23,27.58,63.74,32.01,33.31,75.49-31.26,44.69-19.41-9.26-31.79-2.14-41.74,8.14-27.95,28.88-44.23,31.84-40.38,9.41,2.58-15.04,2.5-19.53-11.32-19.06-16.52.56-22.55-1.68-10.27-17.14,7.88-9.93,13.72-13.54-2.25-22.01-14.85-7.88-55.89-45.79-23.35-82.79,32.54-37.01,78.13-.09,88.02,13.87Z'
	);
	const path3 = pathdata(
		'm48.28,44.51c-4.56,8.97-4.05,22.26,3.27,28.4,7.49,6.29,17.91,6.13,19.99,12.89,2.72,8.85-15.57,23.34-8.15,32.21,3.21,3.84,12.58,4.52,18.58,4.51,6.57,0,12.12-.98,17.94.15,11.26,2.19,18.01,11.14,17.42,20-.35,5.34-3.82,10.96-6.79,17.22-2.58,5.42-5.51,12.4-6.79,17.22-2.53,9.5-4.4,23.92,1.49,29.7,9.2,9.03,20.21,1.16,29.18,3.64,8.11,2.24,14.58,10.46,22.3,14.31,15.1,7.53,29.12,2.77,39.42-2.36,7.98-3.97,16.6-11.63,21.87-21.95,3.1-6.08,6.33-14.29,2.03-17.58-3.96-3.03-13.91-.66-16.44,2.12-2.93,3.22-4.04,8.11-6.35,11.26-2.47,3.38-5.13,5.97-9.18,4.34-4.93-1.98-4.45-7.12-5.44-10.47-1.19-4.03-3.26-8-5.44-10.47-8.6-9.76-28.72-14.1-24.32-26.99,4.02-11.77,19.34-5.07,27.24-2.5,8.17,2.65,16.53,6,22.67,5.44,4.37-.4,10.77-3.94,15.43-7.48,8.05-6.12,17.78-14.98,18.6-27.83.76-11.99-8.5-27.21-20.36-33.52-14.04-7.46-21.95.35-31.57,6.01-6.21,3.65-12.98,10.51-21.7,6.87-7.85-3.28-11.8-23.64-6.24-39.89,3.27-9.54,11.61-15.18,17.16-16.56,8-1.98,17.58,2.15,22.51-4.89,2.33-3.33,2.51-7.04.31-10.52C178.98-.56,131.62-4.8,94.26,5.85c-16.14,4.6-34.44,15.95-45.98,38.66Z',
		'm174.11,78.04c-5.37,18.6-3.81,26.09,11.4,28.37,74.82,11.24,44.95,51.45,4.81,51.81-19.3.17-24.1,5.72-21.71,17.02,14.72,69.79-38.26,73.11-54.43,3.42-4.86-20.95-18.15-26.19-32.38-27.56-40.01-3.84-52.47-14.73-32.53-25.71,13.36-7.36,16.83-10.22,7.84-20.73-10.74-12.57-12.74-18.68,7-18.72,12.67-.03,19.14,2.28,15.81-15.48-3.1-16.52.95-72.24,50.17-69.88,49.22,2.36,48.78,61.02,44.03,77.47Z'
	);
	const path4 = pathdata(
		'm229.64,68.65c-7.72-6.45-20.8-8.92-28.41-3.16-7.8,5.9-9.98,16.09-17.02,16.6-9.24.68-19.27-20.39-29.58-15.14-4.46,2.27-7.21,11.25-8.55,17.1-1.46,6.4-1.75,12.04-4.16,17.46-4.65,10.49-14.88,15.07-23.39,12.52-5.13-1.54-9.83-6.17-15.27-10.47-4.71-3.72-10.86-8.14-15.27-10.47-8.7-4.59-22.33-9.63-29.29-5.18-10.86,6.95-5.64,19.45-10.06,27.63-4,7.41-13.45,11.87-18.93,18.54-10.71,13.03-9.2,27.77-6.5,38.95,2.09,8.67,7.63,18.78,16.52,26.22,5.23,4.38,12.51,9.36,16.68,5.9,3.84-3.19,3.75-13.41,1.61-16.5-2.48-3.57-7-5.75-9.56-8.7-2.75-3.17-4.67-6.33-2.18-9.92,3.03-4.36,7.93-2.75,11.42-2.97,4.19-.26,8.52-1.39,11.42-2.97,11.43-6.2,20.16-24.85,31.74-17.68,10.58,6.55.62,19.98-3.64,27.11-4.41,7.37-9.54,14.77-10.36,20.89-.58,4.35,1.44,11.38,3.85,16.71,4.16,9.21,10.63,20.68,22.98,24.34,11.52,3.42,28.42-2.21,37.22-12.36,10.41-12.02,4.55-21.47,1.19-32.12-2.17-6.87-7.35-15-1.85-22.69,4.95-6.92,25.68-6.22,40.27,2.82,8.57,5.31,12.21,14.7,12.31,20.42.15,8.24-6.02,16.66-.26,23.04,2.72,3.01,6.3,4.01,10.19,2.65,31.64-11.13,46.34-56.35,44.3-95.14-.88-16.76-7.86-37.13-27.42-53.45Z',
		'm169.09,186.65c-16.94-9.38-24.58-9.52-30.2,4.8-27.61,70.44-60.16,32.37-51.58-6.84,4.13-18.86-.21-24.76-11.76-24.95-71.32-1.18-62.77-53.57,8.78-53.83,21.5-.08,29.57-11.87,34.07-25.44,12.65-38.15,26.04-47.87,32.3-26,4.2,14.67,6.22,18.68,18.47,12.26,14.64-7.68,21.05-8.27,16.7,10.99-2.79,12.36-6.49,18.16,11.58,18.86,16.79.65,70.22,17,56.96,64.46-13.26,47.46-70.35,33.98-85.32,25.69Z'
	);
	const path5 = pathdata(
		'm238.94,169.72c.22-10.06-6-21.82-15.25-24.18-9.47-2.42-18.8,2.24-23.6-2.95-6.29-6.8,3.92-27.78-6.61-32.56-4.56-2.07-13.29,1.38-18.7,3.98-5.92,2.85-10.5,6.14-16.24,7.64-11.1,2.91-21.06-2.23-24.37-10.48-1.99-4.97-1.31-11.53-1.34-18.46-.03-6.01-.41-13.56-1.34-18.46-1.83-9.66-6.4-23.46-14.22-26.12-12.2-4.16-18.72,7.72-27.87,9.37-8.28,1.49-17.67-3.11-26.3-3.24-16.87-.24-27.44,10.12-34.5,19.2-5.47,7.04-9.92,17.67-10.2,29.26-.16,6.82.48,15.62,5.79,16.72,4.89,1.01,12.82-5.43,13.9-9.03,1.24-4.17.13-9.06.84-12.9.76-4.12,2.03-7.6,6.39-7.89,5.3-.35,7.1,4.49,9.44,7.08,2.82,3.11,6.41,5.79,9.44,7.08,11.98,5.07,31.99.26,33.61,13.79,1.48,12.35-15.23,12.95-23.47,14.06-8.51,1.15-17.5,1.76-22.79,4.93-3.77,2.26-8,8.22-10.66,13.42-4.6,9-9.54,21.21-4.7,33.14,4.51,11.13,19.45,20.84,32.88,21.39,15.88.65,19.63-9.83,25.85-19.1,4.02-5.98,7.15-15.1,16.58-15.6,8.5-.45,20.88,16.2,22.91,33.24,1.19,10.02-3.88,18.71-8.29,22.36-6.35,5.25-16.78,5.68-18.17,14.17-.66,4.01.79,7.43,4.28,9.61,28.43,17.79,72.95,1.09,102-24.7,12.55-11.14,24.12-29.3,24.69-54.77Z',
		'm109.7,197.34c-3.23-19.09-7.88-25.16-22.58-20.62-72.29,22.34-62.82-26.86-26.81-44.59,17.32-8.53,19.23-15.61,12.18-24.75-43.54-56.49,2.74-82.47,47.56-26.7,13.47,16.76,27.72,15.72,41.13,10.78,37.71-13.9,53.66-9.49,40.46,9.05-8.85,12.43-10.73,16.51,1.93,22.08,15.13,6.66,19.59,11.3,1.82,19.9-11.41,5.52-18.24,6.25-7.53,20.81,9.96,13.54,30.49,65.5-14.88,84.73-45.37,19.22-70.43-33.81-73.28-50.69Z'
	);
	const path6 = pathdata(
		'm65.14,226.62c9.76,2.45,22.61-1,26.96-9.5,4.46-8.7,2-18.83,8.12-22.35,8.03-4.62,26.21,10,33.22.79,3.03-3.98,1.61-13.27.27-19.12-1.46-6.4-3.65-11.6-3.84-17.53-.37-11.47,6.85-20.03,15.63-21.43,5.29-.84,11.54,1.29,18.3,2.8,5.86,1.31,13.32,2.61,18.3,2.8,9.83.36,24.3-1.03,28.63-8.06,6.76-10.97-3.37-19.96-2.94-29.25.39-8.41,6.96-16.54,9-24.92,3.98-16.39-3.77-29.01-11.06-37.91-5.65-6.9-15.03-13.6-26.27-16.44-6.61-1.67-15.34-3-17.59,1.93-2.07,4.54,2.45,13.71,5.72,15.56,3.79,2.14,8.8,2.14,12.39,3.69,3.85,1.66,6.96,3.67,6.27,7.99-.83,5.24-5.95,5.92-9,7.63-3.66,2.06-7.07,4.96-9,7.63-7.6,10.55-7.37,31.13-20.91,29.71-12.37-1.3-9.24-17.73-8.49-26,.77-8.56,2.18-17.45.26-23.32-1.36-4.17-6.24-9.63-10.72-13.38-7.75-6.49-18.56-14.01-31.27-11.95-11.86,1.92-24.64,14.34-28.16,27.3-4.16,15.34,5.22,21.32,12.87,29.45,4.94,5.24,13.13,10.32,11.52,19.63-1.45,8.39-20.43,16.76-37.5,14.95-10.03-1.06-17.38-7.94-19.96-13.05-3.71-7.36-1.81-17.62-9.77-20.86-3.76-1.53-7.42-.88-10.32,2.04-23.66,23.77-17.27,70.88,1.42,104.94,8.08,14.71,23.21,30.03,47.91,36.24Z',
		'm67.11,97.31c19.33,1.1,26.28-2.09,25.12-17.43-5.69-75.45,40.16-55.27,49.44-16.22,4.46,18.78,10.94,22.22,21.42,17.38,64.77-29.88,79.79,21.03,15.45,52.31-19.34,9.4-21.5,23.52-19.66,37.7,5.16,39.86-2.69,54.43-17.82,37.44-10.15-11.39-13.71-14.13-21.96-3.03-9.86,13.27-15.38,16.58-19.81-2.66-2.85-12.35-2.03-19.17-18.61-11.97-15.41,6.7-70.64,15.15-79.29-33.36-8.65-48.51,48.64-61.14,65.73-60.17Z'
	);
	const path7 = pathdata(
		'm165.74,240.01c8-6.1,13.31-18.3,9.39-27-4.02-8.91-13.47-13.3-12.41-20.29,1.39-9.15,24.16-14.26,21.33-25.48-1.22-4.85-9.37-9.53-14.77-12.13-5.91-2.85-11.35-4.38-16.1-7.93-9.19-6.86-11.39-17.85-7.01-25.58,2.64-4.66,8.2-8.22,13.6-12.56,4.68-3.77,10.35-8.78,13.6-12.56,6.41-7.46,14.35-19.64,11.55-27.41-4.36-12.13-17.71-9.82-24.7-15.95-6.33-5.54-8.59-15.76-13.87-22.57-10.33-13.34-25.03-15.14-36.53-15-8.92.11-20,3.26-29.23,10.28-5.43,4.13-11.91,10.12-9.46,14.95,2.25,4.45,12.24,6.64,15.73,5.23,4.03-1.63,7.16-5.55,10.61-7.39,3.7-1.97,7.21-3.15,10.16.08,3.58,3.92.92,8.34.35,11.8-.68,4.15-.54,8.62.35,11.8,3.51,12.53,19.74,25.17,10.19,34.87-8.73,8.86-19.62-3.83-25.62-9.58-6.21-5.94-12.28-12.58-18.06-14.74-4.11-1.54-11.42-1.13-17.14.04-9.91,2.01-22.53,5.77-28.84,16.99-5.89,10.47-4.16,28.21,3.78,39.04,9.4,12.82,19.92,9.21,31.05,8.3,7.18-.59,16.26-3.83,22.53,3.23,5.65,6.36.36,26.42-11.7,38.64-7.09,7.18-17.05,8.64-22.65,7.46-8.07-1.69-14.91-9.57-22.4-5.37-3.54,1.99-5.31,5.25-4.84,9.34,3.82,33.32,44.64,57.71,82.92,64.33,16.54,2.86,37.95.59,58.21-14.86Z',
		'm64.32,157.58c12.91-14.43,14.76-21.85,2.04-30.51-62.53-42.59-18.17-65.86,18.15-48.76,17.46,8.22,24.19,5.3,26.95-5.91,17.02-69.26,66.19-49.27,50.52,20.54-4.71,20.98,4.99,31.47,17.22,38.88,34.38,20.82,40.88,36.04,18.16,37.28-15.23.83-19.59,1.91-16.06,15.28,4.23,15.98,3.38,22.36-14.43,13.83-11.43-5.48-16.26-10.36-20.96,7.09-4.37,16.23-32.2,64.68-75.52,41.19-43.32-23.49-17.48-76.15-6.06-88.9Z'
	);

	async function tick() {
		if ($playing) {
			await t.update(($t: number) => {
				switch ($t) {
					case 1: {
						return 0;
					}

					case 0: {
						return 1;
					}

					default: {
						return Math.round($t);
					}
				}
			});

			await new Promise(function (resolve) {
				setTimeout(resolve, 500);
			});

			return tick();
		}
	}

	$: {
		if ($playing) {
			tick();
		}
	}
</script>

<article>
	<svg xmlns="http://www.w3.org/2000/svg" id="logo" viewBox="0 0 300 300">
		<g transform="translate(21, 21)">
			<path stroke="#ff9500" stroke-width={$strokeWidth} d={$path1} />
			<path stroke="#ff2ebf" stroke-width={$strokeWidth} d={$path2} />
			<path stroke="#ff0000" stroke-width={$strokeWidth} d={$path3} />
			<path stroke="#ffd60a" stroke-width={$strokeWidth} d={$path4} />
			<path stroke="#39e555" stroke-width={$strokeWidth} d={$path5} />
			<path stroke="#8000ff" stroke-width={$strokeWidth} d={$path6} />
			<path stroke="#00b0ff" stroke-width={$strokeWidth} d={$path7} />
		</g>
	</svg>

	<footer>
		{#if $playing}
			<button class="pause" on:click|preventDefault={() => playing.set(false)}>
				<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"
					><path
						d="M370-320h60v-320h-60v320Zm160 0h60v-320h-60v320ZM480-80q-82 0-155-31.5t-127.5-86Q143-252 111.5-325T80-480q0-83 31.5-156t86-127Q252-817 325-848.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 82-31.5 155T763-197.5q-54 54.5-127 86T480-80Z"
					/></svg
				>
			</button>
		{:else}
			<button class="play" on:click|preventDefault={() => playing.set(true)}>
				<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"
					><path
						d="m383-310 267-170-267-170v340Zm97 230q-82 0-155-31.5t-127.5-86Q143-252 111.5-325T80-480q0-83 31.5-156t86-127Q252-817 325-848.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 82-31.5 155T763-197.5q-54 54.5-127 86T480-80Z"
					/></svg
				>
			</button>
		{/if}

		<input
			type="range"
			min="0"
			max="1"
			step="0.01"
			value={$t}
			on:input={(event) => t.set(event.currentTarget.valueAsNumber, { hard: true })}
			disabled={$playing}
		/>

		<span
			>{$t.toLocaleString(undefined, {
				style: 'percent'
			})}</span
		>
	</footer>

	<footer>
		<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"
			><path
				d="M120-160v-30h720v30H120Zm0-90v-60h720v60H120Zm0-120v-90h720v90H120Zm0-150v-280h720v280H120Z"
			/></svg
		>
		<input type="range" min="1" max="20" bind:value={$strokeWidth} />
		<span>{$strokeWidth}</span>
	</footer>
</article>

<style>
	#logo {
		height: 80vh;
		width: 100%;
	}

	#logo path {
		fill: none;
		fill-rule: evenodd;
	}

	button.play,
	button.pause {
		all: unset;
	}

	svg {
		display: block;
		fill: currentColor;
	}

	article {
		align-items: center;
		display: flex;
		flex-direction: column;
		gap: 1rem;
		padding: 1rem;
		width: 100%;
	}

	footer {
		align-items: center;
		display: flex;
	}

	footer span {
		display: block;
		width: 5ch;
	}
</style>
